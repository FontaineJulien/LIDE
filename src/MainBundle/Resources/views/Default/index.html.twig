{% extends "MainBundle::layout.html.twig" %}

{% block navbarCollapse %}
  {{ parent() }}
  <li class="nav-item dropdown active">
    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      Editeur : {{ selected_langage_name }}
    </a>
    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
      {% for lang in list_langage %}
        <a class="dropdown-item {% if lang.id == selected_langage %} choix-langage-selected{% else %} choix-langage{% endif %}" href="#" data-id="{{ lang.id }}">{{ lang.nom }}</a>
      {% endfor %}
    </div>
  </li>
{% endblock %}

{% block title %}
    {{ parent() }} - {{ selected_langage_name }}
{% endblock %}


{% block body %}

<div class="container-fluid m-0 p-0">
    <div class="row m-0 p-0 vh-90" style="z-index : 0">

        <!--Block contenant l'editeur des texte -->
        <div id="block-editor" class="col-8  m-0 p-0 h-100">

          <!-- Barre d'outils : selection du fichier coruant, ajout/suprression d'un fichier  -->
          <div id="editor-toolbar" class="bg-light">
            <select id="select-file" class="custom-select">
              <option value="0" selected>main</option>
            </select>
            <button type="button" id="add_file" class="btn btn-success">Nouveau fichier</button>
            <button type="button" id="rm_file" class="btn btn-danger" disabled>Supprimer</button>
            <!--Caché par default -->
            <form id="form-new-file" class="px-4 py-3 hidden-new-file">
              <div class="input-group m-1">
                <input type="text" class="form-control col" id="new-file-name" placeholder="Entrer le nom du fichier">
                  <span class="input-group-addon" id="extension-addon">.cpp</span>
              </div>
              <div class="form-group m-1">
                <label for="select-modele">Modèle de fichier</label>
                <select id="select-modele" class="custom-select w-50">
                </select>
                <button id="show-model-btn" disabled class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseModele" aria-expanded="false" aria-controls="collapseModele">
                  Show model
                </button>
                <div class="collapse" id="collapseModele">
                  <code id="show-model" class="form-control">
                    Modele
                  </code>
                </div>
              </div>
              <button id="btn-create-file" class="btn-success w-100" type="button">Créer</button>
            </form>
          </div>

          <div id="editor" class="m-0" style="font-size : 16pt"></div>
          <form id="editor-form" class="form-horizontal"  style="width : 75%; position : absolute; top: auto; bottom : 5%; left:12.5%; z-index: 2;">
            <div class="btn-group" id="btn-action-file" role="group">

              <!--Bouton sauvegarde : trois option : sauvegarder uniquement le fichier en cours, tous les fichiers dans une archive, tous les fichiers un par un. -->
              <div class="btn-group w-50 dropup">
                <button id="btn-save" type="button" class="btn btn-primary btn_save m-0 w-100">Save file</button>
                <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <span class="sr-only">Toggle Dropdown</span>
                </button>
                <div class="dropdown-menu">
                  <a class="dropdown-item save-method" id="save-file" href="#" data-save-method="file">Save file</a>
                  <a class="dropdown-item save-method" id="save-all-archive" href="#" data-save-method="archive">Save All (as an archive)</a>
                  <a class="dropdown-item save-method" id="save-all" href="#" data-save-method="all-files">Save All</a>
                </div>
              </div>

              <div class="btn-group w-50 dropup">

                <button type="button" class="btn btn-secondary btn_save w-50 m-0">Run</button>
                <button type="button" class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                  <span class="sr-only">Toggle Dropdown</span>
                </button>
                  <div class="dropdown-menu p-1">
                    <form class="form-control">
                      {{ form_start(form) }}
                      {{ form_errors(form) }}
                      <div class="form-check">
                        <label class="custom-control custom-checkbox">
                          {{ form_widget(form.compileOnly, {'attr': {'class': 'custom-control-input'}}) }}
                          <span class="custom-control-indicator"></span>
                          <span class="custom-control-description">{{ form.compileOnly.vars.label }}</span>
                        </label>
                      </div>
                      <div class="form-group">
                          {{ form_label(form.inputMode)}}
                          {% for  mode in form.inputMode.children %}
                          <div class="form-check inputModeOption">
                            <label class="custom-control custom-radio">
                              {% if mode.vars.value == 'it' %}
                                {{ form_widget(mode, {'attr': {'class': 'custom-control-input', 'checked' : 'checked'}})}}
                              {% else %}
                              {{ form_widget(mode, {'attr': {'class': 'custom-control-input'}})}}
                              {% endif %}
                              <span class="custom-control-indicator"></span>
                              <span class="custom-control-description">{{ mode.vars.label}}</span>
                            </label>
                          </div>
                          {% endfor %}
                          {{ form_widget(form.inputs, { 'attr' : { 'disabled' : ''}})}}
                      </div>
                      {{ form_end(form,  {'render_rest': false}) }}
                    </form>
                  </div>
              </div>
            </div>
          </form>
        </div>


        <div id="console-block" class="console-block-open col-4 m-0 p-0 h-100">

          <div id="console-toogle" data-toggle="tooltip" title="Toggle Console" class="left-0 console-toogle-open h-100">&gt;</div>

          <div id="console">
          </div>

        </div>
    </div>
 </div>

{% endblock %}

{% block stylesheet %}
  {{ parent () }}
  <link rel="stylesheet" href="{{ asset('css/ide.css') }}" />
  <link rel="stylesheet" href="{{ asset('css/jqconsole.css') }}"/>
{% endblock %}

{% block javascript %}
  {{ parent() }}

  <script src="{{ asset('js/plugins/ace/ace.js')}}"></script>

  <!--Script pour la sauvegarde des ficheirs -->
  <script src="{{ asset('js/plugins/FileSaver.min.js')}}"></script>
  <script src="{{asset('js/plugins/jszip.min.js')}}"></script>

  <script src="{{asset('js/jqconsole.js')}}"></script>

  <!-- Variable globale dont la valeur dépend de symfony -->
  <script>
    var urlLangagesInfo = "{{path('language_info')}}";

    var PATH_CONSOLE_EXEC = "exec";
    var PATH_CONSOLE_ANS = "answer";
  </script>

  <script src="{{asset('js/console.js')}}"></script>
  <script src="{{ asset('js/ide.js')}}"></script>
  <script src="{{ asset('js/gestionRunForm.js')}}"></script>
{% endblock %}
